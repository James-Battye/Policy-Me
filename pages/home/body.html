<script src="https://js.adsrvr.org/up_loader.1.1.0.js" type="text/javascript"></script>
<script type="text/javascript">
  ttd_dom_ready(function () {

    if (typeof TTDUniversalPixelApi === 'function') {

      var universalPixelApi = new TTDUniversalPixelApi();

      universalPixelApi.init("md2k0fe", ["nktc6mr"], "https://insight.adsrvr.org/track/up");
    }
  });
</script>

<script>
  fetch('https://api.reviews.io/reviews?store=policyme-com')
    .then(response => response.json())
    .then(data => {
      // Update the content of the script block with fetched data
      const script = document.getElementById('reviews');
      const _reviews = data.reviews.map(r => ({
        "@type": "Review",
        "reviewRating": {
          "@type": "Rating",
          "ratingValue": r.rating,
        },
        "author": {
          "@type": "Person",
          "name": r.author.name
        },
        "reviewBody": r.comments
      }));
      script.textContent = JSON.stringify({
        ...JSON.parse(script.textContent),
        aggregateRating: {
          "@type": "AggregateRating",
          "ratingValue": data.average_rating,
          "reviewCount": data.review_count,
        },
        review: _reviews,
      });
      const parent = script.parentElement;
      const newScript = document.createElement('script');
      newScript.type = 'application/ld+json';
      newScript.id = 'reviews';
      newScript.textContent = script.textContent;
      parent.removeChild(script);
      parent.appendChild(newScript);
    })
    .catch(error => console.error('Error fetching data:', error));
</script>